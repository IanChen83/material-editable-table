"use strict";function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!=typeof b&&"function"!=typeof b?a:b}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var _extends=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a},_createClass=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_react=require("react"),_react2=_interopRequireDefault(_react),_Table=require("material-ui/Table"),_TextField=require("material-ui/TextField"),_TextField2=_interopRequireDefault(_TextField),_getMuiTheme=require("material-ui/styles/getMuiTheme"),_getMuiTheme2=_interopRequireDefault(_getMuiTheme),_lightBaseTheme=require("material-ui/styles/baseThemes/lightBaseTheme"),_lightBaseTheme2=_interopRequireDefault(_lightBaseTheme),_Toggle=require("material-ui/Toggle"),_Toggle2=_interopRequireDefault(_Toggle),_colors=require("material-ui/styles/colors"),JsonMaterialTable=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,Object.getPrototypeOf(b).call(this,a));return c.state={editing:a.editing&&a.editable,editedTextField:{},currentValue:void 0,currentClick:"-1"},c.renderHeader=c.renderHeader.bind(c),c.renderRow=c.renderRow.bind(c),c.onToggleChanged=c.onToggleChanged.bind(c),c.onCellClick=c.onCellClick.bind(c),c.onTextFieldBlur=c.onTextFieldBlur.bind(c),c.colNum=c.props.columns?c.props.columns.length:0,c}return _inherits(b,a),_createClass(b,[{key:"renderRow",value:function(b,c){var d=this.renderRowColumn.bind(this,b,c);return _react2.default.createElement(_Table.TableRow,{key:c},this.props.columns.map(d))}},{key:"renderHeader",value:function(){return this.props.columns&&0!=this.props.columns.length?_react2.default.createElement(_Table.TableHeader,{displaySelectAll:!1,adjustForCheckbox:!1},_react2.default.createElement(_Table.TableRow,null,this.props.columns.map(this.renderHeaderColumn))):(console.error("JsonMaterialTable needs columns be specified."),_react2.default.createElement(_Table.TableHeader,{displaySelectAll:!1,adjustForCheckbox:!1},_react2.default.createElement(_Table.TableRow,null,_react2.default.createElement(_Table.TableRowColumn,{style:{textAlign:"center"}},"沒有可以顯示的資料"))))}},{key:"renderRowColumn",value:function(b,c,d,e){if(!this.state.editing||d.readonly||!this.props.editable)return _react2.default.createElement(_Table.TableRowColumn,{key:e},b[d.name]);var f=(c*this.colNum+e).toString();return f==this.state.currentClick?_react2.default.createElement(_Table.TableRowColumn,{key:e},_react2.default.createElement(_TextField2.default,{autoFocus:!0,onBlur:this.onTextFieldBlur.bind(this,c,e),defaultValue:this.state.currentValue,floatingLabelText:b[d.name],floatingLabelStyle:{color:_colors.teal600},floatingLabelFocusStyle:{color:_colors.orange500}})):this.state.editedTextField[f]?_react2.default.createElement(_Table.TableRowColumn,{key:e},_react2.default.createElement(_TextField2.default,{onBlur:this.onTextFieldBlur.bind(this,c,e),defaultValue:this.state.editedTextField[f],floatingLabelText:b[d.name],floatingLabelStyle:{color:_colors.teal600},floatingLabelFocusStyle:{color:_colors.orange500}})):_react2.default.createElement(_Table.TableRowColumn,{key:e},b[d.name])}},{key:"renderHeaderColumn",value:function(b,c){return _react2.default.createElement(_Table.TableHeaderColumn,{key:c,tooltip:b.tooltip||b.name},b.name)}},{key:"renderToggle",value:function(){return this.props.showToggle&&this.props.editable?_react2.default.createElement(_Toggle2.default,{style:{maxWidth:250},onToggle:this.onToggleChanged,toggled:this.state.editing}):null}},{key:"render",value:function(){var b,c,d;return b=this.renderToggle(),c=this.renderHeader(),d=this.props.items?this.props.items.map(this.renderRow):_react2.default.createElement(_Table.TableRow,null,_react2.default.createElement(_Table.TableRowColumn,null,"沒有可以顯示的資料")),_react2.default.createElement("div",{className:"table-container"},b,_react2.default.createElement(_Table.Table,_extends({},this.props,{selectable:!1,onCellClick:this.onCellClick}),c,_react2.default.createElement(_Table.TableBody,{displayRowCheckbox:!1},d)))}},{key:"getChildContext",value:function(){return{muiTheme:(0,_getMuiTheme2.default)(_lightBaseTheme2.default)}}},{key:"onToggleChanged",value:function(b,c){this.setState({editing:c})}},{key:"onCellClick",value:function(b,c){var d=(b*this.colNum+c-1).toString(),e=Object.assign({},this.state);e.currentClick=d,e.currentValue=e.editedTextField[d]||this.props.items[b][this.props.columns[c-1].name],delete e.editedTextField[d],this.setState(e)}},{key:"onTextFieldBlur",value:function(b,c,d){var e=(b*this.colNum+c).toString(),f=Object.assign({},this.state);d.target.value===this.props.items[b][this.props.columns[c].name]?delete f.editedTextField[e]:f.editedTextField[e]=d.target.value,f.currentValue=void 0,f.currentClick="-1",this.setState(f)}}]),b}(_react2.default.Component);JsonMaterialTable.propTypes={columns:_react2.default.PropTypes.array.isRequired,items:_react2.default.PropTypes.array,editable:_react2.default.PropTypes.bool,editing:_react2.default.PropTypes.bool,showToggle:_react2.default.PropTypes.bool},JsonMaterialTable.defaultProps={columns:[],items:[],editable:!1,editing:!1,showToggle:!1},JsonMaterialTable.childContextTypes={muiTheme:_react2.default.PropTypes.object.isRequired},module.exports=JsonMaterialTable;